import React from "react";
import Link from "next/link";
import Avatar from "./avatar";
import { cn } from "./lib/utils";
import { FaStar } from "react-icons/fa6";
import { isExternalLink } from "./utils";
import { SmartLink } from "./components/smart-link";

export type SocialProofBannerProps = {
  userCount: number;
  starRating: number;
  description: string;
  avatars: string[];
  link?: {
    label: string;
    url: string;
  };
  className?: string;
};

const SocialProofBanner = ({
  description,
  starRating,
  className,
  userCount,
  avatars,
  link,
}: SocialProofBannerProps) => {
  if (!avatars.length) {
    avatars = [1, 2, 3, 4, 5, 6, 7].map(
      (i) => `https://i.pravatar.cc/40?img=${i + 20}`
    );
  }

  const extraCount = userCount - avatars.length;

  return (
    <div className={cn(className, "mx-auto w-full max-w-5xl")}>
      <div className="flex flex-wrap flex-row gap-y-4 items-center justify-center">
        <Laurel className="size-20 text-indigo-300 -scale-x-100" />
        <div className="flex flex-col items-center justify-center">
          <div className="text-4xl text-center font-black text-black">
            <span>{userCount}+</span>
          </div>
          <div className="flex items-center gap-1">
            {[...Array(starRating)].map((_, i) => (
              <FaStar key={i} className="h-4 w-4 fill-orange-400" />
            ))}
          </div>
        </div>
        <Laurel className="size-20 text-indigo-300 block lg:hidden" />

        <div className="flex">
          <div className="mx-2.5 text-sm text-center text-gray-700 font-medium w-[370px]">
            <p>
              {description}{" "}
              {link && (
                <SmartLink href={link.url} className="font-bold text-blue-600">
                  {link.label}
                </SmartLink>
              )}
            </p>
          </div>
        </div>

        <div className="flex flex-nowrap items-center gap-2">
          <div className="flex -space-x-2">
            {avatars.map((avatar, i) => (
              <Avatar
                key={i}
                src={avatar}
                alt={`Customer ${i}`}
                className="border-2 border-purple-100"
              />
            ))}
            <Avatar className="border-2 border-purple-100 text-[10px] font-bold">
              {`+${extraCount}`}
            </Avatar>
          </div>
        </div>
        <Laurel className="size-20 text-indigo-300 hidden lg:block" />
      </div>
    </div>
  );
};

function Laurel(props: React.SVGProps<SVGSVGElement>) {
  return (
    <svg
      width="1em"
      height="1em"
      viewBox="0 0 93 236"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
      {...props}
    >
      <path d="M25.4467 6.7249L27.4285 8.80243L28.1803 9.85617C28.5819 10.4273 29.4475 11.4739 30.0868 12.1907C30.726 12.9075 32.0543 14.4067 33.0396 15.5376L34.8121 17.5594L34.7591 16.7141C34.7304 16.2572 34.3996 14.6266 34.0546 13.1345C33.3133 10.0617 33.2141 7.75147 33.757 6.20366C34.162 5.00854 35.7018 1.86153 35.8839 1.8501C36.1344 1.83439 37.6495 7.40445 37.8794 9.24781C38.1835 11.5452 37.9307 12.6161 36.6807 14.5523C35.6155 16.1558 35.024 17.2938 35.0498 17.705C35.0584 17.8421 36.0807 19.2 37.3422 20.7264C38.5823 22.277 40.4447 24.6372 41.4428 25.9737C42.4423 27.333 43.3123 28.4482 43.3578 28.4453C43.5172 28.4353 42.2836 25.5311 41.7182 24.5344C40.9008 23.1637 39.8608 20.4308 39.4246 18.5774C39.1066 17.1524 39.0737 16.627 39.2935 15.0306C39.5631 13.133 40.4525 9.82036 40.7029 9.80465C40.9078 9.7918 44.0125 15.5603 44.7931 17.4379C45.3259 18.6431 45.5169 19.5026 45.6386 21.0776C45.7846 23.0409 45.7505 23.2265 44.963 25.2483C43.5032 28.9408 43.4419 28.6923 46.267 32.9188C47.6041 34.9221 49.1733 37.3465 49.7814 38.2946L50.8494 40.0166L50.634 38.7687C50.4999 38.089 50.0909 36.6697 49.7048 35.616C48.1532 31.2867 47.9423 30.4743 47.6395 27.8327C47.3866 25.6238 47.4048 24.82 47.632 23.7048C48.0453 21.9128 49.8974 17.1866 50.1394 17.4008C50.4797 17.7235 53.3104 24.9541 53.7622 26.6918C54.358 28.9021 54.5228 31.5294 54.1705 32.8359C53.9999 33.397 53.3772 34.7664 52.7843 35.8815C52.1687 36.9981 51.5304 38.4831 51.3684 39.1813L51.0616 40.485L53.2378 44.5686C54.454 46.8318 55.7031 49.2534 56.0207 49.9445C56.3625 50.657 56.673 51.2338 56.7186 51.231C56.9007 51.2195 56.3059 47.9312 55.6131 45.2682C54.2461 39.8724 54.0995 36.4412 55.0985 33.4199C55.5803 31.9906 58.0144 27.0673 58.2421 27.053C58.4925 27.0373 60.5719 34.3151 61.1024 36.9424C62.0422 41.7228 61.6291 43.8817 59.1915 47.2915C58.5174 48.2053 57.7367 49.6075 57.4425 50.3828L56.8896 51.7707L57.8468 53.9125C58.3539 55.0733 59.2955 57.3308 59.9223 58.9428C62.1846 64.7642 62.0152 64.6143 61.5409 60.3321C60.5036 50.7183 60.8083 47.924 63.264 43.7104C64.4187 41.7114 66.168 39.354 66.363 39.5481C66.6805 39.8723 68.0388 48.0439 68.2021 50.6483C68.5131 55.6058 67.9972 57.2208 65.0033 60.8718C63.8783 62.2497 62.7847 63.7632 62.5615 64.213C62.2032 65.0612 62.2047 65.084 62.9514 67.5142C63.3547 68.8421 64.0388 71.368 64.4907 73.1057C64.9198 74.8448 65.3644 76.4683 65.4698 76.691C65.7348 77.2708 66.1245 73.6454 66.2025 69.7874C66.3073 65.2625 67.1168 61.4044 68.4378 59.1426C69.2227 57.809 72.2834 54.1308 73.6888 52.85L74.5323 52.0861L74.6223 56.0713C74.7226 60.9503 74.6142 63.5946 74.16 66.1919C73.5041 69.9486 72.5301 71.5464 69.244 74.1837C68.2867 74.9548 67.1004 76.0842 66.614 76.711C65.6639 77.9633 65.6822 77.5264 66.5054 82.2683C67.5938 88.3238 68.1725 93.9067 68.3416 99.8823C68.4066 102.011 68.5354 103.7 68.6492 103.693C68.7631 103.686 68.7489 103.825 68.6437 103.969C68.5171 104.137 68.4236 105.198 68.4042 106.346C68.3711 108.734 67.9939 115.11 67.7827 116.844C67.6876 117.515 67.641 118.229 67.6553 118.457C67.6983 119.143 70.6593 115.333 72.2021 112.599C74.9195 107.818 78.1366 103.717 80.8152 101.6C81.9262 100.727 84.4515 99.4452 86.7536 98.6128C88.3855 98.0288 93.1009 96.678 93.2446 96.7836C93.3884 96.8893 88.9606 105.011 87.3608 107.565C85.0728 111.172 82.083 114.525 80.2705 115.51C78.4139 116.521 77.3596 116.839 74.0997 117.342C71.7234 117.721 68.5846 118.697 67.7766 119.298C67.6457 119.398 67.3432 120.77 67.1006 122.368C66.5629 126.186 65.9369 129.689 65.4242 132.083C65.1728 133.177 65.0238 134.081 65.0736 134.147C65.3142 134.338 68.8273 130.219 70.8453 127.409C73.9129 123.111 77.4362 119.518 80.0809 117.953C81.2916 117.212 84.2168 116.111 86.354 115.564C88.4698 115.042 92.7641 114.268 92.9321 114.395C93.0531 114.502 88.8167 120.937 86.8385 123.653C85.0067 126.153 81.4764 129.999 80.0567 131.051C77.8489 132.657 76.5257 133.061 71.6876 133.548C68.6681 133.875 66.9933 134.141 66.0998 134.472L64.8278 134.965L63.8674 138.603C63.0903 141.519 61.4505 147.08 60.5865 149.703C60.2767 150.594 63.7119 147.42 67.0672 143.7C68.9475 141.61 71.0711 139.39 71.7881 138.794C73.414 137.385 76.087 135.543 77.3077 134.962C79.594 133.878 83.7688 133.02 87.9581 132.757L90.5308 132.596L88.773 134.816C81.7186 143.699 77.5552 147.653 73.826 149.056C72.3961 149.582 71.9877 149.63 68.6081 149.682C64.154 149.732 62.7453 149.866 61.3338 150.321L60.2354 150.666L59.3031 153.293C58.7999 154.746 57.7197 157.566 56.908 159.567L55.4211 163.192L57.1226 162.26C59.4202 160.992 61.0391 159.835 63.6878 157.605C67.5272 154.314 72.0839 151.528 75.7064 150.246C77.3611 149.66 84.0819 149.307 87.3251 149.632C88.7282 149.773 89.9962 149.946 90.1613 150.027C90.3506 150.13 89.1672 151.305 86.8073 153.403C80.2028 159.253 76.1114 162.17 72.4335 163.662C70.8073 164.337 70.4231 164.407 68.0254 164.443C65.9478 164.482 64.8904 164.387 62.9634 163.912C61.0379 163.459 59.9791 163.342 57.9015 163.381L55.276 163.431L53.5914 167.183C52.1058 170.464 49.0262 176.758 48.1205 178.352C47.8531 178.827 48.2316 178.666 50.458 177.357C51.912 176.486 53.861 175.125 54.8169 174.331C59.3789 170.536 62.5385 168.434 66.1864 166.829C68.965 165.577 71.5661 165.138 75.8438 165.191C78.5418 165.205 82.6531 165.521 82.8709 165.714C82.9919 165.821 75.447 172.349 73.3089 173.974C67.1151 178.72 63.241 180.362 59.0827 180.027C58.0482 179.931 56.3162 179.65 55.2261 179.397C53.8114 179.073 52.5463 178.946 50.537 178.98L47.7963 179.014L44.9538 183.986C43.411 186.721 41.6961 189.626 41.1771 190.462C40.6566 191.274 40.2869 191.939 40.3552 191.935C40.6284 191.918 44.1156 190.3 44.9749 189.788C45.5041 189.479 47.106 188.415 48.5513 187.407C51.7052 185.214 52.8945 184.497 55.4469 183.282C61.172 180.538 64.8759 180.191 71.8295 181.727C74.6815 182.374 77.4297 183.188 77.4426 183.393C77.4242 183.463 76.38 184.309 75.0912 185.261C65.9185 192.075 62.3519 194.248 58.0052 195.645C54.6217 196.728 52.5739 196.513 47.5085 194.468C44.4143 193.24 41.6035 192.522 40.1478 192.636C39.8973 192.652 39.0724 193.713 37.9718 195.479C36.9934 197.008 34.6924 200.41 32.8465 203.048C28.4592 209.264 28.7493 208.787 29.556 208.53C31.2591 207.987 35.3594 205.941 37.0694 204.779C41.3002 201.899 45.197 199.888 48.8038 198.722C51.2909 197.924 54.3162 197.688 57.1069 198.086C59.1832 198.392 64.3622 199.695 66.2352 200.404L67.3581 200.815L64.9938 202.477C59.2366 206.531 57.4156 207.746 54.7239 209.291C50.6195 211.635 48.1425 212.593 45.4417 212.9C42.5588 213.219 41.0986 212.898 37.0351 211.157C34.0277 209.855 31.91 209.254 29.5434 209.058L28.6227 208.955L26.9573 211.193C20.9582 219.157 11.5772 230.006 5.98984 235.561L0 231.457C0.975222 230.455 2.17711 229.206 3.69091 227.629C7.55266 223.603 20.1644 209.302 21.4458 207.502L22.2663 206.372L21.4201 204.178C20.7648 202.476 20.1254 201.392 18.5748 199.265C15.878 195.626 15.2171 194.2 14.91 191.49C14.7643 190.261 14.7522 188.61 14.8557 187.709C15.0725 185.7 16.1763 181.434 17.2466 178.454C18.4916 174.981 21.6616 167.213 21.8665 167.201C22.1611 167.159 25.0351 172.529 26.1376 175.167C27.5664 178.632 27.9727 180.373 27.9439 182.828C27.886 187.006 26.9785 191.123 24.9047 196.689C23.7292 199.813 22.8597 203.078 22.6884 205.085L22.6091 206.007L23.0955 205.38C26.9683 200.435 31.5519 194.07 34.7658 189.189L36.6643 186.295L35.8937 184.577C35.1444 182.836 34.8155 182.329 32.2911 179.253C29.371 175.698 28.4536 173.462 28.4634 169.975C28.4744 165.777 29.6278 160.842 32.4632 152.843C33.2392 150.639 33.9754 148.528 34.0905 148.177L34.2994 147.499L35.1809 148.797C37.9205 152.753 40.3845 157.782 41.0261 160.724C41.7248 163.845 41.1637 169.476 39.6064 174.895C39.0793 176.694 38.4598 178.843 38.2154 179.684C37.7664 181.272 37.2087 184.77 37.3781 184.92C37.6201 185.134 43.1529 175.682 46.0279 170.135C48.9242 164.563 49.1033 164.139 48.8781 163.465C48.4178 161.957 46.806 159.581 44.7487 157.394C42.4694 154.945 41.0597 152.878 40.4413 151.036C40.1891 150.295 40.0662 149.064 40.024 146.933C39.9353 142.604 40.6935 138.657 43.3802 129.017C43.7184 127.849 44.0168 126.775 44.0736 126.588C44.129 126.378 44.6643 126.895 45.4873 127.99C49.7731 133.638 51.7258 137.805 51.978 141.826C52.1817 145.437 51.4939 150.87 50.228 155.468C49.7264 157.311 49.263 161.583 49.4413 162.604C49.5183 163.104 50.0487 162.084 51.884 157.818C54.3177 152.161 56.0859 147.554 57.6364 142.755L58.553 139.877L57.841 138.729C56.8726 137.138 55.9188 136.143 52.8453 133.423C49.991 130.918 48.9644 129.492 48.2831 127.012C47.8356 125.343 47.6192 118.613 47.951 115.886C48.2813 113.136 49.4576 105.287 49.5643 105.166C49.7563 104.947 53.0892 108.522 54.9587 110.997C57.8733 114.828 58.6754 117.048 59.0064 122.325C59.2499 125.842 59.2344 126.325 58.7014 130.945C58.4164 133.326 58.3899 134.726 58.5515 136.574L58.776 139.06L59.485 136.516C61.1459 130.563 62.5532 123.846 63.2965 118.203L63.6212 115.729L62.9449 114.785C61.7403 113.072 60.6469 112.039 58.2299 110.31C55.9552 108.664 54.3479 107.09 53.502 105.63C52.4012 103.749 51.6564 99.1628 51.747 94.7764C51.8208 91.2168 52.4434 82.9209 52.6483 82.9081C52.9215 82.8909 57.0073 86.8089 58.3399 88.3767C61.1789 91.7307 62.0079 93.6512 62.8013 98.6473C63.1509 100.942 63.1969 102.04 63.0745 105.19C62.9339 109.143 63.0877 112.689 63.4811 114.224C63.6708 115.06 63.7091 114.943 63.9344 112.705C64.7291 104.237 64.6265 94.2209 63.7029 87.5128L63.4217 85.5809L61.7834 84.6057C60.6674 83.9418 59.2855 83.4092 57.5648 82.9437C56.1473 82.5739 54.4181 81.9714 53.7107 81.6258C50.2392 79.8482 47.9705 75.7474 45.1772 66.1979C44.5316 63.9219 44.0242 62.0271 44.0654 61.9557C44.2375 61.7844 49.8325 64.2546 51.3982 65.1655C55.3168 67.5114 57.8401 71.2981 60.1086 78.3117C60.9009 80.7391 63.1413 85.4838 63.3746 85.194C63.4813 85.0726 62.6053 79.8524 61.9507 76.7054C61.0367 72.3361 58.9871 64.8042 58.245 63.1764C57.8746 62.374 55.4509 61.6315 52.2106 61.3531C48.993 61.0733 47.4758 60.5721 46.0266 59.3328C43.924 57.5151 41.764 54.4167 39.1092 49.2621C38.0966 47.3302 37.2606 45.6625 37.2548 45.5711C37.2405 45.3427 37.5408 45.3926 40.6916 46.0666C47.0418 47.4572 49.7863 49.6704 53.9134 56.7968C55.2976 59.187 57.6228 62.3668 57.8361 62.1241C57.9428 62.0027 56.4041 57.8791 54.954 54.438C53.1805 50.2144 50.4772 44.65 50.0245 44.3573C49.3085 43.8747 47.8114 43.6934 44.7975 43.7448C41.2115 43.7863 40.302 43.4993 38.1467 41.5703C36.4057 40.051 35.1927 38.5675 32.5826 34.8551C31.5275 33.3387 30.5991 32.0208 30.5237 31.9109C30.3258 31.671 32.9598 31.7581 35.2653 32.0722C39.4165 32.6604 42.3317 34.6794 45.897 39.4098C47.2696 41.2503 49.7241 43.9404 49.8734 43.7705C50.1095 43.5263 42.3029 30.5757 41.5014 29.8232C41.3562 29.6947 39.7567 29.7033 37.6848 29.8333C34.338 30.0432 34.0391 30.0161 32.9361 29.5577C32.28 29.3007 30.8921 28.3098 29.8031 27.346C27.7232 25.5269 23.415 20.6137 23.6497 20.3467C23.9057 20.0554 29.4556 20.3495 30.7593 20.7264C32.8998 21.3261 35.0564 22.911 38.0432 26.0723C38.9743 27.0689 39.9253 28.0184 40.1872 28.1855C40.6185 28.5025 40.6171 28.4796 40.143 27.8442C39.8909 27.4701 39.0394 26.285 38.2407 25.2113C36.5875 22.9067 32.383 17.4595 31.9232 17.0525C31.5089 16.6428 29.622 16.807 28.1466 17.3353C25.1985 18.4376 23.2388 17.8037 18.8871 14.384C17.418 13.1918 16.1866 12.1451 16.1809 12.0538C16.1637 11.7796 17.9495 11.4612 20.2263 11.3184C21.82 11.2184 22.4191 11.2955 23.4268 11.691C24.9269 12.285 26.4457 13.176 28.0315 14.4068C29.2585 15.3848 31.0634 16.4643 31.1914 16.3186C31.2341 16.2701 30.7599 15.6347 30.1449 14.9393C28.6656 13.2202 26.3704 10.1532 25.58 8.84956L24.3328 7.43579C23.5827 6.84182 23.2646 6.38013 22.2741 6.56295C20.278 6.68815 19.3273 6.68619 17.7203 5.84661C15.8998 4.88282 14.5723 0.330441 14.8496 0.0148825C14.9776 -0.130761 17.6294 0.842491 18.9044 0.762519C22.4288 1.04244 22.4288 1.04244 23.4894 1.97788C24.1341 2.54645 24.6938 5.28852 24.7564 6.28656L25.4467 6.7249Z" />
      <path d="M81.089 66.9728C74.7597 71.0166 72.7076 74.0123 70.5326 82.3367C69.9998 84.4114 69.1799 87.0087 68.7207 88.0696C68.263 89.1533 67.9546 90.0672 68.0044 90.1328C68.0756 90.1743 68.6446 89.7716 69.2733 89.2276C69.9234 88.6593 71.531 87.6869 72.8598 87.0072C76.4735 85.2209 77.6457 84.23 78.9382 81.8783C79.8212 80.2862 81.0151 77.0921 81.6558 74.5519C82.1317 72.6643 83.5675 66.0376 83.5503 65.7634C83.5317 65.4664 83.176 65.6264 81.089 66.9728Z" />
      <path d="M86.634 82.1295C82.0242 84.07 80.2246 85.2609 78.0698 87.7125C76.0231 90.0657 74.4504 92.6872 72.5425 96.8894C71.8402 98.4472 70.6942 100.583 70.0059 101.636C69.3162 102.665 68.8 103.546 68.8484 103.589C68.8982 103.655 69.675 103.285 70.5799 102.769C71.4861 102.277 73.0469 101.651 74.1283 101.4C79.4612 100.056 81.4656 98.4857 84.3322 93.5353C85.383 91.7033 90.0162 81.3899 89.9861 80.9101C89.9732 80.7045 89.7498 80.7873 86.634 82.1295Z" />
    </svg>
  );
}

export default SocialProofBanner;
